import pandas as pd
import os

def preprocess_exploit_data():
    path = os.path.join(os.path.dirname(__file__), '..', 'data', 'exploits', 'exploitdb', 'files_exploits.csv')
    data = pd.read_csv(path)
    data['description'] = data['description'].fillna('')
    processed_data = data[['id', 'description']]
    processed_data.to_csv(os.path.join(os.path.dirname(__file__), '..', 'data', 'datasets', 'processed_exploits.csv'), index=False)

def preprocess_shellcodes_data():
    path = os.path.join(os.path.dirname(__file__), '..', 'data', 'exploits', 'exploitdb', 'files_shellcodes.csv')
    data = pd.read_csv(path)
    data['code'] = data['code'].fillna('')
    processed_data = data[['id', 'code']]
    processed_data.to_csv(os.path.join(os.path.dirname(__file__), '..', 'data', 'datasets', 'processed_shellcodes.csv'), index=False)

if __name__ == "__main__":
    preprocess_exploit_data()
    preprocess_shellcodes_data()
